<!DOCTYPE html>
<html lang="lv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí£ Bomb Puzzle Master - GR≈™TS RE≈Ωƒ™MS</title>
<style>
/* -- dizains paliek nemainƒ´ts -- */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Segoe UI', sans-serif; background:linear-gradient(135deg,#0c0c0c 0%,#1a1a2e 50%,#16213e 100%); color:white; min-height:100vh; overflow-x:hidden; }
.fullscreen { position:fixed; top:0; left:0; width:100vw; height:100vh; overflow-y:auto; }
.container { max-width:1800px; margin:0 auto; padding:20px; }
.header { text-align:center; margin-bottom:30px; position:relative; }
.title { font-size:3rem; font-weight:bold; background:linear-gradient(45deg,#ff0000,#ff6b6b,#ff0000); -webkit-background-clip:text; -webkit-text-fill-color:transparent; text-shadow:0 0 20px rgba(255,0,0,0.5); margin-bottom:10px; }
.subtitle { font-size:1.2rem; color:#ff6b6b; margin-bottom:20px; }
.control-panel { position:fixed; top:20px; right:20px; display:flex; flex-direction:column; gap:10px; z-index:1000; }
.control-btn { padding:12px 20px; font-size:1rem; font-weight:bold; border:none; border-radius:8px; cursor:pointer; transition:all 0.3s ease; background:#333; color:white; border:2px solid #555; }
.control-btn:hover { transform:scale(1.05); background:#444; }
.btn-connect { background:linear-gradient(45deg,#228B22,#32CD32); border-color:#00ff00; }
.btn-disconnect { background:linear-gradient(45deg,#cc0000,#ff4444); border-color:#ff6666; }
.btn-fullscreen { background:linear-gradient(45deg,#1a1a2e,#16213e); border-color:#00ccff; }
.serial-status { padding:10px 15px; border-radius:5px; font-weight:bold; text-align:center; min-width:200px; }
.serial-connected { background:rgba(34,139,34,0.2); color:#00ff00; border:2px solid #00ff00; }
.serial-disconnected { background:rgba(204,0,0,0.2); color:#ff4444; border:2px solid #ff4444; }
.columns { display:flex; gap:30px; margin-bottom:30px; }
.hints-column { flex:1; min-width:450px; }
.game-column { flex:2; min-width:700px; }
.section-title { font-size:1.8rem; font-weight:bold; color:#00ccff; margin-bottom:15px; text-shadow:0 0 10px rgba(0,204,255,0.5); border-bottom:2px solid #00ccff; padding-bottom:5px; }
.difficulty-badge { display:inline-block; padding:5px 15px; background:linear-gradient(45deg,#ff0000,#ff6b6b); color:white; border-radius:20px; font-weight:bold; margin-left:15px; font-size:1rem; }
.hint-table { background:rgba(26,26,26,0.8); border-radius:15px; padding:20px; margin-bottom:20px; border:2px solid #333; backdrop-filter:blur(10px); }
.hint-row { display:flex; align-items:center; margin-bottom:12px; padding:12px; background:rgba(42,42,42,0.9); border-radius:8px; border-left:4px solid #ff6b6b; transition:all 0.3s ease; }
.hint-row:hover { transform:translateX(5px); border-left-color:#00ff00; }
.color-dot { width:35px; height:35px; border-radius:50%; margin-right:10px; border:3px solid #444; display:inline-block; box-shadow:0 0 10px rgba(0,0,0,0.5); }
.timer-section { text-align:center; margin-bottom:30px; background:rgba(26,26,26,0.8); border-radius:15px; padding:25px; border:2px solid #333; }
.time-display { font-family:'Consolas', monospace; font-size:2.5rem; color:#ff4444; margin-bottom:20px; text-shadow:0 0 15px #ff4444; background:rgba(0,0,0,0.5); padding:15px; border-radius:10px; border:2px solid #ff4444; }
.progress-bar { width:100%; height:25px; background:#333; border-radius:12px; overflow:hidden; margin-bottom:20px; border:2px solid #444; }
.progress-fill { height:100%; background:linear-gradient(90deg,#ff0000,#ff6b6b,#ff0000); transition:width 1s linear; box-shadow:0 0 10px rgba(255,0,0,0.5); }
.timer-controls { display:flex; gap:20px; justify-content:center; margin-bottom:25px; }
.btn { padding:15px 30px; font-size:1.3rem; font-weight:bold; border:none; border-radius:10px; cursor:pointer; transition:all 0.3s ease; box-shadow:0 5px 15px rgba(0,0,0,0.3); }
.btn:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,0.4); }
.btn:active { transform:translateY(0); }
.btn:disabled { opacity:0.6; cursor:not-allowed; transform:none; }
.btn-start { background:linear-gradient(45deg,#228B22,#32CD32); color:white; }
.btn-stop { background:linear-gradient(45deg,#cc0000,#ff4444); color:white; }
.btn-delete { background:linear-gradient(45deg,#444,#666); color:white; }
.btn-submit { background:linear-gradient(45deg,#228B22,#32CD32); color:white; }
.current-input { text-align:center; margin-bottom:30px; padding:25px; background:rgba(26,26,26,0.8); border-radius:15px; border:2px solid #00ccff; }
.current-input-text { font-size:1.5rem; color:white; min-height:50px; display:flex; align-items:center; justify-content:center; flex-wrap:wrap; gap:12px; padding:15px; background:rgba(0,0,0,0.3); border-radius:10px; border:1px solid #444; }
.color-tag { padding:10px 20px; border-radius:25px; font-weight:bold; border:2px solid transparent; box-shadow:0 3px 10px rgba(0,0,0,0.3); transition:all 0.3s ease; }
.color-tag:hover { transform:scale(1.05); border-color:white; }
.actions { display:flex; gap:20px; justify-content:center; margin-bottom:30px; }
.color-buttons { display:flex; gap:15px; justify-content:center; flex-wrap:wrap; margin-bottom:30px; }
.color-btn { padding:18px 30px; font-size:1.3rem; font-weight:bold; border:none; border-radius:12px; cursor:pointer; transition:all 0.3s ease; min-width:140px; box-shadow:0 5px 15px rgba(0,0,0,0.3); border:3px solid transparent; }
.color-btn:hover { transform:translateY(-3px) scale(1.05); box-shadow:0 8px 20px rgba(0,0,0,0.4); border-color:white; }
.color-btn:active { transform:translateY(0); }
.history-section { background:rgba(26,26,26,0.8); border-radius:15px; padding:25px; max-height:400px; overflow-y:auto; border:2px solid #333; }
.history-row { display:flex; align-items:center; margin-bottom:12px; padding:12px; background:rgba(42,42,42,0.9); border-radius:8px; border-left:4px solid #00ccff; transition:all 0.3s ease; }
.history-row:hover { transform:translateX(5px); background:rgba(50,50,50,0.9); }
.hint-text { margin-left:20px; font-size:1.2rem; }
.victory { color:#00ff00; font-weight:bold; text-shadow:0 0 10px #00ff00; }
.defeat { color:#ff4444; font-weight:bold; text-shadow:0 0 10px #ff4444; }
.penalty-warning { color:#ffaa00; font-size:0.9rem; margin-top:5px; }
@media(max-width:1200px){.columns{flex-direction:column}.hints-column,.game-column{min-width:auto}.control-panel{position:static;flex-direction:row;justify-content:center;margin-bottom:20px}}
</style>
</head>
<body>
<div class="fullscreen">
<div class="control-panel">
<button class="control-btn btn-connect" onclick="connectSerial()">üîå CONNECT COM</button>
<button class="control-btn btn-disconnect" onclick="disconnectSerial()">üî¥ DISCONNECT</button>
<button class="control-btn btn-fullscreen" onclick="toggleFullscreen()">‚§¢ FULLSCREEN</button>
<div class="serial-status serial-disconnected" id="serialStatus">COM: Nav savienots</div>
</div>
<div class="container">
<div class="header">
<h1 class="title">üí£ BOMB PUZZLE MASTER</h1>
<div class="subtitle">GR≈™TS RE≈Ωƒ™MS <span class="difficulty-badge">HARD</span></div>
</div>
<div class="columns">
<div class="hints-column">
<h2 class="section-title">SƒÅkotnƒìjie pavedieni: <span class="difficulty-badge">GR≈™TI</span></h2>
<div class="hint-table" id="hintsContainer"></div>
</div>
<div class="game-column">
<div class="timer-section">
<div class="time-display" id="timeDisplay">05:00</div>
<div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
<div class="timer-controls">
<button class="btn btn-start" onclick="startTimer()">‚ñ∂Ô∏è START</button>
<button class="btn btn-stop" onclick="stopTimer()">‚è∏Ô∏è STOP</button>
</div>
<div class="penalty-warning">‚ö†Ô∏è Katra nepareiza mƒìƒ£inƒÅjuma sods: -30 sekundes!</div>
</div>
<div class="current-input">
<h3 class="section-title">Tava pa≈°reizƒìjƒÅ kombinƒÅcija:</h3>
<div class="current-input-text" id="currentInput">Izvƒìlies krƒÅsas...</div>
</div>
<div class="actions">
<button class="btn btn-delete" onclick="deleteLast()">‚¨ÖÔ∏è DZƒíST PEDƒíJO</button>
<button class="btn btn-submit" onclick="submitGuess()">‚úÖ IESNIEGT KODU</button>
</div>
<div class="color-buttons" id="colorButtons"></div>
<h3 class="section-title">Tavi mƒìƒ£inƒÅjumi:</h3>
<div class="history-section" id="historyContainer"></div>
</div>
</div>
</div>
</div>
<script>
const CODE_LENGTH=5; const TOTAL_TIME=300; const PENALTY=30;
const COLORS={"BTN1":{name:"VIOLETS",color:"#8A2BE2",textColor:"white"},"BTN2":{name:"ZAƒª≈†",color:"#2E8B57",textColor:"white"},"BTN3":{name:"BALTS",color:"#F8F8FF",textColor:"black"},"BTN4":{name:"MELNS",color:"#000000",textColor:"white"},"BTN5":{name:"PELƒíKS",color:"#808080",textColor:"white"}};
const ORDER=["BTN1","BTN2","BTN3","BTN4","BTN5"];
let gameState={secret:[],current:[],timeLeft:TOTAL_TIME,timerRunning:false,gameOver:false,serialPort:null,reader:null,history:[]};

document.addEventListener('DOMContentLoaded',function(){initializeGame();setupColorButtons();checkSerialSupport();});

function initializeGame(){gameState.secret=generateSecret(); renderHints(); updateTimerDisplay(); updateCurrentInput();}
function generateSecret(){let secret=[];for(let i=0;i<CODE_LENGTH;i++){secret.push(ORDER[Math.floor(Math.random()*ORDER.length)]);} return secret;}
function renderHints(){const container=document.getElementById('hintsContainer'); container.innerHTML=''; gameState.secret.forEach(colorId=>{const row=document.createElement('div'); row.className='hint-row'; const dot=document.createElement('span'); dot.className='color-dot'; dot.style.backgroundColor=COLORS[colorId].color; row.appendChild(dot); const hintText=document.createElement('span'); hintText.className='hint-text'; hintText.textContent='?'; row.appendChild(hintText); container.appendChild(row); });}
function setupColorButtons(){const container=document.getElementById('colorButtons'); container.innerHTML=''; ORDER.forEach(btnId=>{const color=COLORS[btnId]; const button=document.createElement('button'); button.className='color-btn'; button.textContent=color.name; button.style.background=color.color; button.style.color=color.textColor; button.onclick=()=>addInput(btnId); container.appendChild(button);});}
function addInput(btnId){if(gameState.gameOver||gameState.current.length>=CODE_LENGTH) return; gameState.current.push(btnId); updateCurrentInput();}
function deleteLast(){if(gameState.current.length>0){gameState.current.pop(); updateCurrentInput();}}
function updateCurrentInput(){const container=document.getElementById('currentInput'); container.innerHTML=''; if(gameState.current.length===0){container.textContent='Izvƒìlies krƒÅsas...'; return;} gameState.current.forEach(colorId=>{const color=COLORS[colorId]; const tag=document.createElement('span'); tag.className='color-tag'; tag.textContent=color.name; tag.style.background=color.color; tag.style.color=color.textColor; container.appendChild(tag);}); const submitBtn=document.querySelector('.btn-submit'); submitBtn.disabled=gameState.current.length!==CODE_LENGTH;}
function evaluateGuess(guess){const secretCopy=[...gameState.secret]; const guessCopy=[...guess]; let correctPos=0, wrongPlace=0; for(let i=CODE_LENGTH-1;i>=0;i--){if(guessCopy[i]===secretCopy[i]){correctPos++; guessCopy.splice(i,1); secretCopy.splice(i,1);}} for(let g of guessCopy){const index=secretCopy.indexOf(g); if(index!==-1){wrongPlace++; secretCopy.splice(index,1);}} return {correctPos, wrongPlace};}
function submitGuess(){if(gameState.current.length<CODE_LENGTH){alert('‚ùå Nepilns kods!'); return;} const guess=[...gameState.current]; gameState.current=[]; updateCurrentInput(); if(guess.join()===gameState.secret.join()){endGame(true,guess); return;} if(gameState.timeLeft<=0){endGame(false,guess); return;} const hintData=evaluateGuess(guess); addToHistory(guess,hintData,'try');}
function addToHistory(guess,hintData,result){const historyContainer=document.getElementById('historyContainer'); const row=document.createElement('div'); row.className='history-row'; guess.forEach(colorId=>{const dot=document.createElement('span'); dot.className='color-dot'; dot.style.backgroundColor=COLORS[colorId].color; row.appendChild(dot);}); const resultText=document.createElement('span'); resultText.className='hint-text'; if(result==='win'){resultText.textContent='üéâ UZVARA!'; resultText.className+=' victory';} else if(result==='lose'){resultText.textContent='üí£ ZAUDƒíJUMS!'; resultText.className+=' defeat';} else{resultText.textContent=`üîµ ${hintData.correctPos} vietƒÅ, ${hintData.wrongPlace} citur (-${PENALTY}s)`;} row.appendChild(resultText); historyContainer.appendChild(row); historyContainer.scrollTop=historyContainer.scrollHeight; gameState.history.push({guess,hintData,result});}
function startTimer(){if(!gameState.timerRunning&&!gameState.gameOver){gameState.timerRunning=true; gameState.timerInterval=setInterval(tick,1000);}}
function stopTimer(){gameState.timerRunning=false; if(gameState.timerInterval){clearInterval(gameState.timerInterval);}}
function tick(){if(gameState.timerRunning&&!gameState.gameOver){gameState.timeLeft--; updateTimerDisplay(); if(gameState.timeLeft<=0){gameState.timeLeft=0; endGame(false);}}}
function updateTimerDisplay(){const minutes=Math.floor(gameState.timeLeft/60); const seconds=gameState.timeLeft%60; document.getElementById('timeDisplay').textContent=`${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`; const progressPercent=(gameState.timeLeft/TOTAL_TIME)*100; document.getElementById('progressFill').style.width=`${progressPercent}%`; if(progressPercent<20){document.getElementById('progressFill').style.background='linear-gradient(90deg,#ff0000,#ff4444)';} else if(progressPercent<50){document.getElementById('progressFill').style.background='linear-gradient(90deg,#ff6b6b,#ffaa00)';}}
function endGame(victory,guess=null){gameState.gameOver=true; stopTimer(); if(guess){addToHistory(guess,null,victory?'win':'lose');} setTimeout(()=>{if(victory){alert('üéâ APSVEICAM! Tu atminƒìji kodu!'); window.open('https://youtube.com','_blank');} else{alert('üí£ ZAUDƒíJI!'); window.open('https://ss.com','_blank');}},1000);}
async function connectSerial(){try{if(!('serial' in navigator)){throw new Error('Web Serial API nav atbalstƒ´ta');} gameState.serialPort=await navigator.serial.requestPort(); await gameState.serialPort.open({baudRate:9600,dataBits:8,stopBits:1,parity:'none'}); updateSerialStatus(true); startSerialReading();}catch(error){console.error(error); updateSerialStatus(false,error.message); alert('Kƒº≈´da savienojoties ar COM portu: '+error.message);}}
async function disconnectSerial(){try{if(gameState.reader){await gameState.reader.cancel(); gameState.reader=null;} if(gameState.serialPort){await gameState.serialPort.close(); gameState.serialPort=null;} updateSerialStatus(false,'Atvienots manuƒÅli');}catch(error){console.error(error);}}
async function startSerialReading(){try{const decoder=new TextDecoder(); gameState.reader=gameState.serialPort.readable.getReader(); while(true){const {value,done}=await gameState.reader.read(); if(done){gameState.reader.releaseLock(); break;} const text=decoder.decode(value).trim().toUpperCase(); processSerialInput(text);}}catch(error){console.error(error); updateSerialStatus(false,'Reading error');}}
function processSerialInput(text){if(text.startsWith("BTN")&&ORDER.includes(text.substring(0,4))){addInput(text.substring(0,4));} else if(/^[1-5]$/.test(text)){addInput(`BTN${text}`);}}
function updateSerialStatus(connected,message=''){const statusElement=document.getElementById('serialStatus'); if(connected){statusElement.textContent='COM: Savienots ‚úì'; statusElement.className='serial-status serial-connected';} else{statusElement.textContent=`COM: Nav savienots ${message?' - '+message:''}`; statusElement.className='serial-status serial-disconnected';}}
function checkSerialSupport(){if(!('serial' in navigator)){alert('‚ö†Ô∏è Web Serial API nav atbalstƒ´ta. L≈´dzu izmantojiet Chrome, Edge vai Opera.');}}
function toggleFullscreen(){if(!document.fullscreenElement){document.documentElement.requestFullscreen().catch(err=>{console.error(err);});} else{document.exitFullscreen();}}
document.addEventListener('keydown',function(e){if(e.key==='Escape'){if(document.fullscreenElement){document.exitFullscreen();}}});
window.connectSerial=connectSerial; window.disconnectSerial=disconnectSerial; window.startTimer=startTimer; window.stopTimer=stopTimer; window.addInput=addInput; window.deleteLast=deleteLast; window.submitGuess=submitGuess; window.toggleFullscreen=toggleFullscreen;
</script>
</body>
</html>
